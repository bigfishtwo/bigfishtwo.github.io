---
title: Python 和Matlab中计算SVD的差别
date: 2024-08-20 +0800
categories: [代码笔记]
tags: [Python]
math: true
---


计算SVD的公式：
$$ X=U \Sigma V^h $$
，其中 ^h 表示共轭转置。

在 matlab 中计算 SVD， 得到的是 U、V和S：
```
m = 10; 
n = 5;
A=randn(m,n);
[U,S,V]=svd(A);
```

而在 Python 中使用 numpy 计算 SVD， 得到的是U、S 的对角线数组和 V^h, 如果想要得到和 matlab 一致的结果， 需要将 S放回0矩阵里，计算 $V^h$ 的共轭转置：
```
import numpy as np

m = 10
n = 5
A = np.random.randn(m, n)
U, sdiag, VH = np.linalg.svd(A)
S = np.zeros((m, n))
np.fill_diagonal(S, sdiag)
V = VH.T.conj()
```

Matlab 中的 ` [U,S,V] = svd(A,'econ');` 对应于 `U, S, Vh = np.linalg.svd(A, full_matrices=False)`。

参考：
- https://numpy.org/doc/stable/reference/generated/numpy.linalg.svd.html
- https://stackoverflow.com/questions/50930899/svd-command-in-python-v-s-matlab